<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>vue3</title>
    </head>
    <body>
        <div id="app"></div>
        <script>
            const createAppApi = render => {
                return function (options) {
                    const app = {
                        mount(selector) {
                            // 生成虚拟节点
                            const vNode = {
                                tag: 'h1',
                                props: '',
                                children: options.data().text
                            }
                            render(vNode, selector)
                        }
                    }
                    return app
                }
            }

            const createRenderer = ({ createElement, insert, createDom }) => {
                const render = (vNode, selector) => {
                    const parent = createElement(selector)
                    const child = createDom(vNode)
                    insert(child, parent)
                }
                return {
                    render,
                    createApp: createAppApi(render)
                }
            }

            const renderer = createRenderer({
                createElement(selector) {
                    return document.querySelector(selector)
                },
                createDom(vNode) {
                    const ele = document.createElement(vNode.tag)
                    const content = document.createTextNode(vNode.children)
                    ele.appendChild(content)
                    return ele
                },
                insert(child, parent) {
                    parent.appendChild(child)
                }
            })

            const Vue = {
                createApp: renderer.createApp
            }
            const { createApp } = Vue
            const app = createApp({
                data() {
                    return {
                        text: 'vue3'
                    }
                }
            })

            app.mount('#app')
        </script>
    </body>
</html>
